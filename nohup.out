Loaded plugins: fastestmirror, priorities
Loading mirror speeds from cached hostfile
 * base: mirrors.163.com
 * epel: mirror.wanxp.id
 * extras: mirrors.163.com
 * updates: mirrors.163.com
Package diskimage-builder-1.4.0-1.el7.noarch already installed and latest version
Nothing to do
+ true
+ case "$1" in
+ QEMU_IMG_OPTIONS=compat=0.10
+ shift 2
+ true
+ case "$1" in
+ shift
+ break
+ export DIB_IMAGE_CACHE=/root/.cache/image-create
+ DIB_IMAGE_CACHE=/root/.cache/image-create
+ mkdir -p /root/.cache/image-create
+ '[' '' = 1 -a /root '!=' '' ']'
+ source /usr/bin/../share/diskimage-builder/lib/img-defaults
++ source /usr/bin/../share/diskimage-builder/lib/common-defaults
+++ '[' -f /etc/debian_version ']'
++++ uname -m
+++ _ARCH=x86_64
+++ case $_ARCH in
+++ _ARCH=amd64
+++ ARCH=amd64
+++ export ARCH
+++ export DIB_NO_TMPFS=0
+++ DIB_NO_TMPFS=0
+++ export DIB_MIN_TMPFS=2
+++ DIB_MIN_TMPFS=2
+++ _BASE_ELEMENT_DIR=/usr/bin/../share/diskimage-builder/elements
+++ ELEMENTS_PATH=/usr/share/diskimage-builder/elements:./elements:/usr/bin/../share/diskimage-builder/elements
+++ export ELEMENTS_PATH=/usr/share/diskimage-builder/elements:./elements:/usr/bin/../share/diskimage-builder/elements
+++ ELEMENTS_PATH=/usr/share/diskimage-builder/elements:./elements:/usr/bin/../share/diskimage-builder/elements
+++ export DIB_OFFLINE=
+++ DIB_OFFLINE=
+++ [[ :/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin:/home/centos/.local/bin:/home/centos/bin =~ :/sbin ]]
+++ export PATH=/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin:/home/centos/.local/bin:/home/centos/bin:/sbin
+++ PATH=/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin:/home/centos/.local/bin:/home/centos/bin:/sbin
+++ [[ :/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin:/home/centos/.local/bin:/home/centos/bin:/sbin =~ :/usr/sbin ]]
+++ [[ :/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin:/home/centos/.local/bin:/home/centos/bin:/sbin =~ :/usr/local/sbin ]]
++ FS_TYPE=ext4
++ export IMAGE_TYPE=qcow2
++ IMAGE_TYPE=qcow2
++ export IMAGE_NAME=centos-mysql-guest-image
++ IMAGE_NAME=centos-mysql-guest-image
+ source /usr/bin/../share/diskimage-builder/lib/common-functions
+ source /usr/bin/../share/diskimage-builder/lib/img-functions
+ '[' 0 == 1 ']'
+ '[' -z centos-mysql-guest-image ']'
+ arg_to_elements centos-mysql-guest-image
+ for arg in '"$@"'
+ IMAGE_ELEMENT=' centos-mysql-guest-image'
+ '[' '' '!=' 1 ']'
+ IMAGE_ELEMENT='base  centos-mysql-guest-image'
+ '[' 0 == 1 ']'
+ echo 'Building elements: base  centos-mysql-guest-image'
Building elements: base  centos-mysql-guest-image
++ /usr/bin/element-info base centos-mysql-guest-image
+ IMAGE_ELEMENT='epel rpm-distro install-types redhat-common centos-trove-guest dib-run-parts cache-url vm centos-mysql-guest-image manifests centos7 pkg-map base selinux-permissive yum dib-init-system cloud-init-datasources trove-guest source-repositories package-installs system-configuration'
+ export IMAGE_ELEMENT
+ echo 'Expanded element dependencies to: epel rpm-distro install-types redhat-common centos-trove-guest dib-run-parts cache-url vm centos-mysql-guest-image manifests centos7 pkg-map base selinux-permissive yum dib-init-system cloud-init-datasources trove-guest source-repositories package-installs system-configuration'
Expanded element dependencies to: epel rpm-distro install-types redhat-common centos-trove-guest dib-run-parts cache-url vm centos-mysql-guest-image manifests centos7 pkg-map base selinux-permissive yum dib-init-system cloud-init-datasources trove-guest source-repositories package-installs system-configuration
+ '[' 1 = 1 ']'
+ export IMAGE_NAME=centos-mysql-guest-image
+ IMAGE_NAME=centos-mysql-guest-image
+ for X in '${!IMAGE_TYPES[@]}'
+ case "${IMAGE_TYPES[$X]}" in
++ which qemu-img
+ '[' -z /usr/bin/qemu-img ']'
++ uuidgen -r
+ export DIB_IMAGE_ROOT_FS_UUID=00bcc69b-6b3f-4999-a546-c25448026e9c
+ DIB_IMAGE_ROOT_FS_UUID=00bcc69b-6b3f-4999-a546-c25448026e9c
+ echo ext4
+ grep -q '^ext'
+ '[' -z 00bcc69b-6b3f-4999-a546-c25448026e9c ']'
+ '[' -z '' ']'
+ '[' ext4 = xfs ']'
+ DIB_ROOT_LABEL=cloudimg-rootfs
+ mk_build_dir
++ mktemp -t -d --tmpdir=/tmp image.XXXXXXXX
+ TMP_BUILD_DIR=/tmp/image.j0k1q4y3
++ mktemp -t -d --tmpdir=/tmp image.XXXXXXXX
+ TMP_IMAGE_DIR=/tmp/image.Sh3HzKKq
+ '[' 0 -eq 0 ']'
+ export TMP_BUILD_DIR
+ tmpfs_check
+ local echo_message=1
+ '[' 0 == 0 ']'
+ '[' -r /proc/meminfo ']'
++ awk '/^MemTotal/ { print $2 }' /proc/meminfo
+ total_kB=8011304
+ RAM_NEEDED=4
+ '[' 8011304 -lt 4194304 ']'
+ return 0
+ sudo mount -t tmpfs tmpfs /tmp/image.j0k1q4y3
+ sudo mount -t tmpfs tmpfs /tmp/image.Sh3HzKKq
++ id -u
++ id -g
+ sudo chown 0:0 /tmp/image.j0k1q4y3 /tmp/image.Sh3HzKKq
+ trap trap_cleanup EXIT
+ echo Building in /tmp/image.j0k1q4y3
Building in /tmp/image.j0k1q4y3
+ export TMP_IMAGE_PATH=/tmp/image.Sh3HzKKq/image.raw
+ TMP_IMAGE_PATH=/tmp/image.Sh3HzKKq/image.raw
+ export OUT_IMAGE_PATH=/tmp/image.Sh3HzKKq/image.raw
+ OUT_IMAGE_PATH=/tmp/image.Sh3HzKKq/image.raw
+ export TMP_HOOKS_PATH=/tmp/image.j0k1q4y3/hooks
+ TMP_HOOKS_PATH=/tmp/image.j0k1q4y3/hooks
+ create_base
+ mkdir /tmp/image.j0k1q4y3/mnt
+ export TMP_MOUNT_PATH=/tmp/image.j0k1q4y3/mnt
+ TMP_MOUNT_PATH=/tmp/image.j0k1q4y3/mnt
+ TARGET_ROOT=/tmp/image.j0k1q4y3/mnt
+ run_d root
+ check_element
+ '[' -d /tmp/image.j0k1q4y3/hooks ']'
+ generate_hooks
+ mkdir -p /tmp/image.j0k1q4y3/hooks
+ for _ELEMENT in '$IMAGE_ELEMENT'
+ for dir in '${ELEMENTS_PATH//:/ }'
+ '[' -d /usr/share/diskimage-builder/elements/epel ']'
++ find /usr/share/diskimage-builder/elements/epel -follow -mindepth 1 -maxdepth 1 -type d -not -name tests
+ for _DIR in '$(find $dir/$_ELEMENT -follow -mindepth 1 -maxdepth 1 -type d -not -name tests)'
+ copy_hooks_not_overwrite /usr/share/diskimage-builder/elements/epel/pre-install.d
++ basename /usr/share/diskimage-builder/elements/epel/pre-install.d
+ _DIR=pre-install.d
+ test -d /tmp/image.j0k1q4y3/hooks/pre-install.d
+ mkdir /tmp/image.j0k1q4y3/hooks/pre-install.d
++ ls /usr/share/diskimage-builder/elements/epel/pre-install.d
+ for _HOOK in '$(ls $1)'
+ '[' '!' -f /tmp/image.j0k1q4y3/hooks/pre-install.d/05-rpm-epel-release ']'
+ cp -t /tmp/image.j0k1q4y3/hooks/pre-install.d -a /usr/share/diskimage-builder/elements/epel/pre-install.d/05-rpm-epel-release
++ find /usr/share/diskimage-builder/elements/epel -follow -maxdepth 1 -type f
+ for _FILE in '$(find $dir/$_ELEMENT -follow -maxdepth 1 -type f)'
+ cp -t /tmp/image.j0k1q4y3/hooks -a /usr/share/diskimage-builder/elements/epel/README.rst
+ for _FILE in '$(find $dir/$_ELEMENT -follow -maxdepth 1 -type f)'
+ cp -t /tmp/image.j0k1q4y3/hooks -a /usr/share/diskimage-builder/elements/epel/element-deps
+ for _FILE in '$(find $dir/$_ELEMENT -follow -maxdepth 1 -type f)'
+ cp -t /tmp/image.j0k1q4y3/hooks -a /usr/share/diskimage-builder/elements/epel/package-installs.yaml
+ break
+ for _ELEMENT in '$IMAGE_ELEMENT'
+ for dir in '${ELEMENTS_PATH//:/ }'
+ '[' -d /usr/share/diskimage-builder/elements/rpm-distro ']'
++ find /usr/share/diskimage-builder/elements/rpm-distro -follow -mindepth 1 -maxdepth 1 -type d -not -name tests
+ for _DIR in '$(find $dir/$_ELEMENT -follow -mindepth 1 -maxdepth 1 -type d -not -name tests)'
+ copy_hooks_not_overwrite /usr/share/diskimage-builder/elements/rpm-distro/finalise.d
++ basename /usr/share/diskimage-builder/elements/rpm-distro/finalise.d
+ _DIR=finalise.d
+ test -d /tmp/image.j0k1q4y3/hooks/finalise.d
+ mkdir /tmp/image.j0k1q4y3/hooks/finalise.d
++ ls /usr/share/diskimage-builder/elements/rpm-distro/finalise.d
+ for _HOOK in '$(ls $1)'
+ '[' '!' -f /tmp/image.j0k1q4y3/hooks/finalise.d/11-selinux-fixfiles-restore ']'
+ cp -t /tmp/image.j0k1q4y3/hooks/finalise.d -a /usr/share/diskimage-builder/elements/rpm-distro/finalise.d/11-selinux-fixfiles-restore
+ for _DIR in '$(find $dir/$_ELEMENT -follow -mindepth 1 -maxdepth 1 -type d -not -name tests)'
+ copy_hooks_not_overwrite /usr/share/diskimage-builder/elements/rpm-distro/post-install.d
++ basename /usr/share/diskimage-builder/elements/rpm-distro/post-install.d
+ _DIR=post-install.d
+ test -d /tmp/image.j0k1q4y3/hooks/post-install.d
+ mkdir /tmp/image.j0k1q4y3/hooks/post-install.d
++ ls /usr/share/diskimage-builder/elements/rpm-distro/post-install.d
+ for _HOOK in '$(ls $1)'
+ '[' '!' -f /tmp/image.j0k1q4y3/hooks/post-install.d/05-fstab-rootfs-label ']'
+ cp -t /tmp/image.j0k1q4y3/hooks/post-install.d -a /usr/share/diskimage-builder/elements/rpm-distro/post-install.d/05-fstab-rootfs-label
+ for _HOOK in '$(ls $1)'
+ '[' '!' -f /tmp/image.j0k1q4y3/hooks/post-install.d/06-network-config-nonzeroconf ']'
+ cp -t /tmp/image.j0k1q4y3/hooks/post-install.d -a /usr/share/diskimage-builder/elements/rpm-distro/post-install.d/06-network-config-nonzeroconf
+ for _DIR in '$(find $dir/$_ELEMENT -follow -mindepth 1 -maxdepth 1 -type d -not -name tests)'
+ copy_hooks_not_overwrite /usr/share/diskimage-builder/elements/rpm-distro/pre-install.d
++ basename /usr/share/diskimage-builder/elements/rpm-distro/pre-install.d
+ _DIR=pre-install.d
+ test -d /tmp/image.j0k1q4y3/hooks/pre-install.d
++ ls /usr/share/diskimage-builder/elements/rpm-distro/pre-install.d
+ for _HOOK in '$(ls $1)'
+ '[' '!' -f /tmp/image.j0k1q4y3/hooks/pre-install.d/00-fix-requiretty ']'
+ cp -t /tmp/image.j0k1q4y3/hooks/pre-install.d -a /usr/share/diskimage-builder/elements/rpm-distro/pre-install.d/00-fix-requiretty
+ for _HOOK in '$(ls $1)'
+ '[' '!' -f /tmp/image.j0k1q4y3/hooks/pre-install.d/00-usr-local-bin-secure-path ']'
+ cp -t /tmp/image.j0k1q4y3/hooks/pre-install.d -a /usr/share/diskimage-builder/elements/rpm-distro/pre-install.d/00-usr-local-bin-secure-path
+ for _HOOK in '$(ls $1)'
+ '[' '!' -f /tmp/image.j0k1q4y3/hooks/pre-install.d/01-override-yum-arch ']'
+ cp -t /tmp/image.j0k1q4y3/hooks/pre-install.d -a /usr/share/diskimage-builder/elements/rpm-distro/pre-install.d/01-override-yum-arch
++ find /usr/share/diskimage-builder/elements/rpm-distro -follow -maxdepth 1 -type f
+ break
+ for _ELEMENT in '$IMAGE_ELEMENT'
+ for dir in '${ELEMENTS_PATH//:/ }'
+ '[' -d /usr/share/diskimage-builder/elements/install-types ']'
++ find /usr/share/diskimage-builder/elements/install-types -follow -mindepth 1 -maxdepth 1 -type d -not -name tests
+ for _DIR in '$(find $dir/$_ELEMENT -follow -mindepth 1 -maxdepth 1 -type d -not -name tests)'
+ copy_hooks_not_overwrite /usr/share/diskimage-builder/elements/install-types/extra-data.d
++ basename /usr/share/diskimage-builder/elements/install-types/extra-data.d
+ _DIR=extra-data.d
+ test -d /tmp/image.j0k1q4y3/hooks/extra-data.d
+ mkdir /tmp/image.j0k1q4y3/hooks/extra-data.d
++ ls /usr/share/diskimage-builder/elements/install-types/extra-data.d
+ for _HOOK in '$(ls $1)'
+ '[' '!' -f /tmp/image.j0k1q4y3/hooks/extra-data.d/99-enable-install-types ']'
+ cp -t /tmp/image.j0k1q4y3/hooks/extra-data.d -a /usr/share/diskimage-builder/elements/install-types/extra-data.d/99-enable-install-types
++ find /usr/share/diskimage-builder/elements/install-types -follow -maxdepth 1 -type f
+ for _FILE in '$(find $dir/$_ELEMENT -follow -maxdepth 1 -type f)'
+ cp -t /tmp/image.j0k1q4y3/hooks -a /usr/share/diskimage-builder/elements/install-types/README.rst
+ break
+ for _ELEMENT in '$IMAGE_ELEMENT'
+ for dir in '${ELEMENTS_PATH//:/ }'
+ '[' -d /usr/share/diskimage-builder/elements/redhat-common ']'
++ find /usr/share/diskimage-builder/elements/redhat-common -follow -mindepth 1 -maxdepth 1 -type d -not -name tests
+ for _DIR in '$(find $dir/$_ELEMENT -follow -mindepth 1 -maxdepth 1 -type d -not -name tests)'
+ copy_hooks_not_overwrite /usr/share/diskimage-builder/elements/redhat-common/bin
++ basename /usr/share/diskimage-builder/elements/redhat-common/bin
+ _DIR=bin
+ test -d /tmp/image.j0k1q4y3/hooks/bin
+ mkdir /tmp/image.j0k1q4y3/hooks/bin
++ ls /usr/share/diskimage-builder/elements/redhat-common/bin
+ for _HOOK in '$(ls $1)'
+ '[' '!' -f /tmp/image.j0k1q4y3/hooks/bin/extract-image ']'
+ cp -t /tmp/image.j0k1q4y3/hooks/bin -a /usr/share/diskimage-builder/elements/redhat-common/bin/extract-image
+ for _HOOK in '$(ls $1)'
+ '[' '!' -f /tmp/image.j0k1q4y3/hooks/bin/map-packages ']'
+ cp -t /tmp/image.j0k1q4y3/hooks/bin -a /usr/share/diskimage-builder/elements/redhat-common/bin/map-packages
+ for _HOOK in '$(ls $1)'
+ '[' '!' -f /tmp/image.j0k1q4y3/hooks/bin/map-services ']'
+ cp -t /tmp/image.j0k1q4y3/hooks/bin -a /usr/share/diskimage-builder/elements/redhat-common/bin/map-services
+ for _DIR in '$(find $dir/$_ELEMENT -follow -mindepth 1 -maxdepth 1 -type d -not -name tests)'
+ copy_hooks_not_overwrite /usr/share/diskimage-builder/elements/redhat-common/finalise.d
++ basename /usr/share/diskimage-builder/elements/redhat-common/finalise.d
+ _DIR=finalise.d
+ test -d /tmp/image.j0k1q4y3/hooks/finalise.d
++ ls /usr/share/diskimage-builder/elements/redhat-common/finalise.d
+ for _HOOK in '$(ls $1)'
+ '[' '!' -f /tmp/image.j0k1q4y3/hooks/finalise.d/01-clean-old-kernels ']'
+ cp -t /tmp/image.j0k1q4y3/hooks/finalise.d -a /usr/share/diskimage-builder/elements/redhat-common/finalise.d/01-clean-old-kernels
+ for _HOOK in '$(ls $1)'
+ '[' '!' -f /tmp/image.j0k1q4y3/hooks/finalise.d/99-cleanup-tmp-grub ']'
+ cp -t /tmp/image.j0k1q4y3/hooks/finalise.d -a /usr/share/diskimage-builder/elements/redhat-common/finalise.d/99-cleanup-tmp-grub
+ for _DIR in '$(find $dir/$_ELEMENT -follow -mindepth 1 -maxdepth 1 -type d -not -name tests)'
+ copy_hooks_not_overwrite /usr/share/diskimage-builder/elements/redhat-common/pre-install.d
++ basename /usr/share/diskimage-builder/elements/redhat-common/pre-install.d
+ _DIR=pre-install.d
+ test -d /tmp/image.j0k1q4y3/hooks/pre-install.d
++ ls /usr/share/diskimage-builder/elements/redhat-common/pre-install.d
+ for _HOOK in '$(ls $1)'
+ '[' '!' -f /tmp/image.j0k1q4y3/hooks/pre-install.d/15-remove-grub ']'
+ cp -t /tmp/image.j0k1q4y3/hooks/pre-install.d -a /usr/share/diskimage-builder/elements/redhat-common/pre-install.d/15-remove-grub
++ find /usr/share/diskimage-builder/elements/redhat-common -follow -maxdepth 1 -type f
+ for _FILE in '$(find $dir/$_ELEMENT -follow -maxdepth 1 -type f)'
+ cp -t /tmp/image.j0k1q4y3/hooks -a /usr/share/diskimage-builder/elements/redhat-common/README.rst
+ for _FILE in '$(find $dir/$_ELEMENT -follow -maxdepth 1 -type f)'
+ cp -t /tmp/image.j0k1q4y3/hooks -a /usr/share/diskimage-builder/elements/redhat-common/element-deps
+ for _FILE in '$(find $dir/$_ELEMENT -follow -maxdepth 1 -type f)'
+ cp -t /tmp/image.j0k1q4y3/hooks -a /usr/share/diskimage-builder/elements/redhat-common/package-installs.yaml
+ break
+ for _ELEMENT in '$IMAGE_ELEMENT'
+ for dir in '${ELEMENTS_PATH//:/ }'
+ '[' -d /usr/share/diskimage-builder/elements/centos-trove-guest ']'
+ continue
+ for dir in '${ELEMENTS_PATH//:/ }'
+ '[' -d ./elements/centos-trove-guest ']'
++ find ./elements/centos-trove-guest -follow -mindepth 1 -maxdepth 1 -type d -not -name tests
++ find ./elements/centos-trove-guest -follow -maxdepth 1 -type f
+ for _FILE in '$(find $dir/$_ELEMENT -follow -maxdepth 1 -type f)'
+ cp -t /tmp/image.j0k1q4y3/hooks -a ./elements/centos-trove-guest/element-deps
+ break
+ for _ELEMENT in '$IMAGE_ELEMENT'
+ for dir in '${ELEMENTS_PATH//:/ }'
+ '[' -d /usr/share/diskimage-builder/elements/dib-run-parts ']'
++ find /usr/share/diskimage-builder/elements/dib-run-parts -follow -mindepth 1 -maxdepth 1 -type d -not -name tests
+ for _DIR in '$(find $dir/$_ELEMENT -follow -mindepth 1 -maxdepth 1 -type d -not -name tests)'
+ copy_hooks_not_overwrite /usr/share/diskimage-builder/elements/dib-run-parts/root.d
++ basename /usr/share/diskimage-builder/elements/dib-run-parts/root.d
+ _DIR=root.d
+ test -d /tmp/image.j0k1q4y3/hooks/root.d
+ mkdir /tmp/image.j0k1q4y3/hooks/root.d
++ ls /usr/share/diskimage-builder/elements/dib-run-parts/root.d
+ for _HOOK in '$(ls $1)'
+ '[' '!' -f /tmp/image.j0k1q4y3/hooks/root.d/90-base-dib-run-parts ']'
+ cp -t /tmp/image.j0k1q4y3/hooks/root.d -a /usr/share/diskimage-builder/elements/dib-run-parts/root.d/90-base-dib-run-parts
++ find /usr/share/diskimage-builder/elements/dib-run-parts -follow -maxdepth 1 -type f
+ break
+ for _ELEMENT in '$IMAGE_ELEMENT'
+ for dir in '${ELEMENTS_PATH//:/ }'
+ '[' -d /usr/share/diskimage-builder/elements/cache-url ']'
++ find /usr/share/diskimage-builder/elements/cache-url -follow -mindepth 1 -maxdepth 1 -type d -not -name tests
+ for _DIR in '$(find $dir/$_ELEMENT -follow -mindepth 1 -maxdepth 1 -type d -not -name tests)'
+ copy_hooks_not_overwrite /usr/share/diskimage-builder/elements/cache-url/bin
++ basename /usr/share/diskimage-builder/elements/cache-url/bin
+ _DIR=bin
+ test -d /tmp/image.j0k1q4y3/hooks/bin
++ ls /usr/share/diskimage-builder/elements/cache-url/bin
+ for _HOOK in '$(ls $1)'
+ '[' '!' -f /tmp/image.j0k1q4y3/hooks/bin/cache-url ']'
+ cp -t /tmp/image.j0k1q4y3/hooks/bin -a /usr/share/diskimage-builder/elements/cache-url/bin/cache-url
++ find /usr/share/diskimage-builder/elements/cache-url -follow -maxdepth 1 -type f
+ for _FILE in '$(find $dir/$_ELEMENT -follow -maxdepth 1 -type f)'
+ cp -t /tmp/image.j0k1q4y3/hooks -a /usr/share/diskimage-builder/elements/cache-url/README.rst
+ for _FILE in '$(find $dir/$_ELEMENT -follow -maxdepth 1 -type f)'
+ cp -t /tmp/image.j0k1q4y3/hooks -a /usr/share/diskimage-builder/elements/cache-url/__init__.py
+ for _FILE in '$(find $dir/$_ELEMENT -follow -maxdepth 1 -type f)'
+ cp -t /tmp/image.j0k1q4y3/hooks -a /usr/share/diskimage-builder/elements/cache-url/__init__.pyc
+ for _FILE in '$(find $dir/$_ELEMENT -follow -maxdepth 1 -type f)'
+ cp -t /tmp/image.j0k1q4y3/hooks -a /usr/share/diskimage-builder/elements/cache-url/__init__.pyo
+ break
+ for _ELEMENT in '$IMAGE_ELEMENT'
+ for dir in '${ELEMENTS_PATH//:/ }'
+ '[' -d /usr/share/diskimage-builder/elements/vm ']'
++ find /usr/share/diskimage-builder/elements/vm -follow -mindepth 1 -maxdepth 1 -type d -not -name tests
+ for _DIR in '$(find $dir/$_ELEMENT -follow -mindepth 1 -maxdepth 1 -type d -not -name tests)'
+ copy_hooks_not_overwrite /usr/share/diskimage-builder/elements/vm/block-device.d
++ basename /usr/share/diskimage-builder/elements/vm/block-device.d
+ _DIR=block-device.d
+ test -d /tmp/image.j0k1q4y3/hooks/block-device.d
+ mkdir /tmp/image.j0k1q4y3/hooks/block-device.d
++ ls /usr/share/diskimage-builder/elements/vm/block-device.d
+ for _HOOK in '$(ls $1)'
+ '[' '!' -f /tmp/image.j0k1q4y3/hooks/block-device.d/10-partition ']'
+ cp -t /tmp/image.j0k1q4y3/hooks/block-device.d -a /usr/share/diskimage-builder/elements/vm/block-device.d/10-partition
+ for _DIR in '$(find $dir/$_ELEMENT -follow -mindepth 1 -maxdepth 1 -type d -not -name tests)'
+ copy_hooks_not_overwrite /usr/share/diskimage-builder/elements/vm/cleanup.d
++ basename /usr/share/diskimage-builder/elements/vm/cleanup.d
+ _DIR=cleanup.d
+ test -d /tmp/image.j0k1q4y3/hooks/cleanup.d
+ mkdir /tmp/image.j0k1q4y3/hooks/cleanup.d
++ ls /usr/share/diskimage-builder/elements/vm/cleanup.d
+ for _HOOK in '$(ls $1)'
+ '[' '!' -f /tmp/image.j0k1q4y3/hooks/cleanup.d/51-bootloader ']'
+ cp -t /tmp/image.j0k1q4y3/hooks/cleanup.d -a /usr/share/diskimage-builder/elements/vm/cleanup.d/51-bootloader
+ for _DIR in '$(find $dir/$_ELEMENT -follow -mindepth 1 -maxdepth 1 -type d -not -name tests)'
+ copy_hooks_not_overwrite /usr/share/diskimage-builder/elements/vm/finalise.d
++ basename /usr/share/diskimage-builder/elements/vm/finalise.d
+ _DIR=finalise.d
+ test -d /tmp/image.j0k1q4y3/hooks/finalise.d
++ ls /usr/share/diskimage-builder/elements/vm/finalise.d
+ for _HOOK in '$(ls $1)'
+ '[' '!' -f /tmp/image.j0k1q4y3/hooks/finalise.d/50-remove-bogus-udev-links ']'
+ cp -t /tmp/image.j0k1q4y3/hooks/finalise.d -a /usr/share/diskimage-builder/elements/vm/finalise.d/50-remove-bogus-udev-links
+ for _HOOK in '$(ls $1)'
+ '[' '!' -f /tmp/image.j0k1q4y3/hooks/finalise.d/51-bootloader ']'
+ cp -t /tmp/image.j0k1q4y3/hooks/finalise.d -a /usr/share/diskimage-builder/elements/vm/finalise.d/51-bootloader
++ find /usr/share/diskimage-builder/elements/vm -follow -maxdepth 1 -type f
+ for _FILE in '$(find $dir/$_ELEMENT -follow -maxdepth 1 -type f)'
+ cp -t /tmp/image.j0k1q4y3/hooks -a /usr/share/diskimage-builder/elements/vm/README.rst
+ break
+ for _ELEMENT in '$IMAGE_ELEMENT'
+ for dir in '${ELEMENTS_PATH//:/ }'
+ '[' -d /usr/share/diskimage-builder/elements/centos-mysql-guest-image ']'
+ continue
+ for dir in '${ELEMENTS_PATH//:/ }'
+ '[' -d ./elements/centos-mysql-guest-image ']'
++ find ./elements/centos-mysql-guest-image -follow -mindepth 1 -maxdepth 1 -type d -not -name tests
+ for _DIR in '$(find $dir/$_ELEMENT -follow -mindepth 1 -maxdepth 1 -type d -not -name tests)'
+ copy_hooks_not_overwrite ./elements/centos-mysql-guest-image/install.d
++ basename ./elements/centos-mysql-guest-image/install.d
+ _DIR=install.d
+ test -d /tmp/image.j0k1q4y3/hooks/install.d
+ mkdir /tmp/image.j0k1q4y3/hooks/install.d
++ ls ./elements/centos-mysql-guest-image/install.d
+ for _HOOK in '$(ls $1)'
+ '[' '!' -f /tmp/image.j0k1q4y3/hooks/install.d/30-mysql ']'
+ cp -t /tmp/image.j0k1q4y3/hooks/install.d -a ./elements/centos-mysql-guest-image/install.d/30-mysql
+ for _HOOK in '$(ls $1)'
+ '[' '!' -f /tmp/image.j0k1q4y3/hooks/install.d/40-percona ']'
+ cp -t /tmp/image.j0k1q4y3/hooks/install.d -a ./elements/centos-mysql-guest-image/install.d/40-percona
+ for _DIR in '$(find $dir/$_ELEMENT -follow -mindepth 1 -maxdepth 1 -type d -not -name tests)'
+ copy_hooks_not_overwrite ./elements/centos-mysql-guest-image/post-install.d
++ basename ./elements/centos-mysql-guest-image/post-install.d
+ _DIR=post-install.d
+ test -d /tmp/image.j0k1q4y3/hooks/post-install.d
++ ls ./elements/centos-mysql-guest-image/post-install.d
+ for _HOOK in '$(ls $1)'
+ '[' '!' -f /tmp/image.j0k1q4y3/hooks/post-install.d/30-register-mysql-service ']'
+ cp -t /tmp/image.j0k1q4y3/hooks/post-install.d -a ./elements/centos-mysql-guest-image/post-install.d/30-register-mysql-service
++ find ./elements/centos-mysql-guest-image -follow -maxdepth 1 -type f
+ for _FILE in '$(find $dir/$_ELEMENT -follow -maxdepth 1 -type f)'
+ cp -t /tmp/image.j0k1q4y3/hooks -a ./elements/centos-mysql-guest-image/element-deps
+ break
+ for _ELEMENT in '$IMAGE_ELEMENT'
+ for dir in '${ELEMENTS_PATH//:/ }'
+ '[' -d /usr/share/diskimage-builder/elements/manifests ']'
++ find /usr/share/diskimage-builder/elements/manifests -follow -mindepth 1 -maxdepth 1 -type d -not -name tests
+ for _DIR in '$(find $dir/$_ELEMENT -follow -mindepth 1 -maxdepth 1 -type d -not -name tests)'
+ copy_hooks_not_overwrite /usr/share/diskimage-builder/elements/manifests/cleanup.d
++ basename /usr/share/diskimage-builder/elements/manifests/cleanup.d
+ _DIR=cleanup.d
+ test -d /tmp/image.j0k1q4y3/hooks/cleanup.d
++ ls /usr/share/diskimage-builder/elements/manifests/cleanup.d
+ for _HOOK in '$(ls $1)'
+ '[' '!' -f /tmp/image.j0k1q4y3/hooks/cleanup.d/01-copy-manifests-dir ']'
+ cp -t /tmp/image.j0k1q4y3/hooks/cleanup.d -a /usr/share/diskimage-builder/elements/manifests/cleanup.d/01-copy-manifests-dir
+ for _DIR in '$(find $dir/$_ELEMENT -follow -mindepth 1 -maxdepth 1 -type d -not -name tests)'
+ copy_hooks_not_overwrite /usr/share/diskimage-builder/elements/manifests/environment.d
++ basename /usr/share/diskimage-builder/elements/manifests/environment.d
+ _DIR=environment.d
+ test -d /tmp/image.j0k1q4y3/hooks/environment.d
+ mkdir /tmp/image.j0k1q4y3/hooks/environment.d
++ ls /usr/share/diskimage-builder/elements/manifests/environment.d
+ for _HOOK in '$(ls $1)'
+ '[' '!' -f /tmp/image.j0k1q4y3/hooks/environment.d/14-manifests ']'
+ cp -t /tmp/image.j0k1q4y3/hooks/environment.d -a /usr/share/diskimage-builder/elements/manifests/environment.d/14-manifests
+ for _DIR in '$(find $dir/$_ELEMENT -follow -mindepth 1 -maxdepth 1 -type d -not -name tests)'
+ copy_hooks_not_overwrite /usr/share/diskimage-builder/elements/manifests/extra-data.d
++ basename /usr/share/diskimage-builder/elements/manifests/extra-data.d
+ _DIR=extra-data.d
+ test -d /tmp/image.j0k1q4y3/hooks/extra-data.d
++ ls /usr/share/diskimage-builder/elements/manifests/extra-data.d
+ for _HOOK in '$(ls $1)'
+ '[' '!' -f /tmp/image.j0k1q4y3/hooks/extra-data.d/20-manifest-dir ']'
+ cp -t /tmp/image.j0k1q4y3/hooks/extra-data.d -a /usr/share/diskimage-builder/elements/manifests/extra-data.d/20-manifest-dir
++ find /usr/share/diskimage-builder/elements/manifests -follow -maxdepth 1 -type f
+ for _FILE in '$(find $dir/$_ELEMENT -follow -maxdepth 1 -type f)'
+ cp -t /tmp/image.j0k1q4y3/hooks -a /usr/share/diskimage-builder/elements/manifests/README.rst
+ break
+ for _ELEMENT in '$IMAGE_ELEMENT'
+ for dir in '${ELEMENTS_PATH//:/ }'
+ '[' -d /usr/share/diskimage-builder/elements/centos7 ']'
++ find /usr/share/diskimage-builder/elements/centos7 -follow -mindepth 1 -maxdepth 1 -type d -not -name tests
+ for _DIR in '$(find $dir/$_ELEMENT -follow -mindepth 1 -maxdepth 1 -type d -not -name tests)'
+ copy_hooks_not_overwrite /usr/share/diskimage-builder/elements/centos7/environment.d
++ basename /usr/share/diskimage-builder/elements/centos7/environment.d
+ _DIR=environment.d
+ test -d /tmp/image.j0k1q4y3/hooks/environment.d
++ ls /usr/share/diskimage-builder/elements/centos7/environment.d
+ for _HOOK in '$(ls $1)'
+ '[' '!' -f /tmp/image.j0k1q4y3/hooks/environment.d/10-centos7-distro-name.bash ']'
+ cp -t /tmp/image.j0k1q4y3/hooks/environment.d -a /usr/share/diskimage-builder/elements/centos7/environment.d/10-centos7-distro-name.bash
+ for _DIR in '$(find $dir/$_ELEMENT -follow -mindepth 1 -maxdepth 1 -type d -not -name tests)'
+ copy_hooks_not_overwrite /usr/share/diskimage-builder/elements/centos7/pre-install.d
++ basename /usr/share/diskimage-builder/elements/centos7/pre-install.d
+ _DIR=pre-install.d
+ test -d /tmp/image.j0k1q4y3/hooks/pre-install.d
++ ls /usr/share/diskimage-builder/elements/centos7/pre-install.d
+ for _HOOK in '$(ls $1)'
+ '[' '!' -f /tmp/image.j0k1q4y3/hooks/pre-install.d/01-set-centos-mirror ']'
+ cp -t /tmp/image.j0k1q4y3/hooks/pre-install.d -a /usr/share/diskimage-builder/elements/centos7/pre-install.d/01-set-centos-mirror
+ for _DIR in '$(find $dir/$_ELEMENT -follow -mindepth 1 -maxdepth 1 -type d -not -name tests)'
+ copy_hooks_not_overwrite /usr/share/diskimage-builder/elements/centos7/root.d
++ basename /usr/share/diskimage-builder/elements/centos7/root.d
+ _DIR=root.d
+ test -d /tmp/image.j0k1q4y3/hooks/root.d
++ ls /usr/share/diskimage-builder/elements/centos7/root.d
+ for _HOOK in '$(ls $1)'
+ '[' '!' -f /tmp/image.j0k1q4y3/hooks/root.d/10-centos7-cloud-image ']'
+ cp -t /tmp/image.j0k1q4y3/hooks/root.d -a /usr/share/diskimage-builder/elements/centos7/root.d/10-centos7-cloud-image
++ find /usr/share/diskimage-builder/elements/centos7 -follow -maxdepth 1 -type f
+ for _FILE in '$(find $dir/$_ELEMENT -follow -maxdepth 1 -type f)'
+ cp -t /tmp/image.j0k1q4y3/hooks -a /usr/share/diskimage-builder/elements/centos7/README.rst
+ for _FILE in '$(find $dir/$_ELEMENT -follow -maxdepth 1 -type f)'
+ cp -t /tmp/image.j0k1q4y3/hooks -a /usr/share/diskimage-builder/elements/centos7/element-deps
+ for _FILE in '$(find $dir/$_ELEMENT -follow -maxdepth 1 -type f)'
+ cp -t /tmp/image.j0k1q4y3/hooks -a /usr/share/diskimage-builder/elements/centos7/element-provides
+ break
+ for _ELEMENT in '$IMAGE_ELEMENT'
+ for dir in '${ELEMENTS_PATH//:/ }'
+ '[' -d /usr/share/diskimage-builder/elements/pkg-map ']'
++ find /usr/share/diskimage-builder/elements/pkg-map -follow -mindepth 1 -maxdepth 1 -type d -not -name tests
+ for _DIR in '$(find $dir/$_ELEMENT -follow -mindepth 1 -maxdepth 1 -type d -not -name tests)'
+ copy_hooks_not_overwrite /usr/share/diskimage-builder/elements/pkg-map/bin
++ basename /usr/share/diskimage-builder/elements/pkg-map/bin
+ _DIR=bin
+ test -d /tmp/image.j0k1q4y3/hooks/bin
++ ls /usr/share/diskimage-builder/elements/pkg-map/bin
+ for _HOOK in '$(ls $1)'
+ '[' '!' -f /tmp/image.j0k1q4y3/hooks/bin/pkg-map ']'
+ cp -t /tmp/image.j0k1q4y3/hooks/bin -a /usr/share/diskimage-builder/elements/pkg-map/bin/pkg-map
+ for _DIR in '$(find $dir/$_ELEMENT -follow -mindepth 1 -maxdepth 1 -type d -not -name tests)'
+ copy_hooks_not_overwrite /usr/share/diskimage-builder/elements/pkg-map/extra-data.d
++ basename /usr/share/diskimage-builder/elements/pkg-map/extra-data.d
+ _DIR=extra-data.d
+ test -d /tmp/image.j0k1q4y3/hooks/extra-data.d
++ ls /usr/share/diskimage-builder/elements/pkg-map/extra-data.d
+ for _HOOK in '$(ls $1)'
+ '[' '!' -f /tmp/image.j0k1q4y3/hooks/extra-data.d/10-create-pkg-map-dir ']'
+ cp -t /tmp/image.j0k1q4y3/hooks/extra-data.d -a /usr/share/diskimage-builder/elements/pkg-map/extra-data.d/10-create-pkg-map-dir
++ find /usr/share/diskimage-builder/elements/pkg-map -follow -maxdepth 1 -type f
+ for _FILE in '$(find $dir/$_ELEMENT -follow -maxdepth 1 -type f)'
+ cp -t /tmp/image.j0k1q4y3/hooks -a /usr/share/diskimage-builder/elements/pkg-map/README.rst
+ break
+ for _ELEMENT in '$IMAGE_ELEMENT'
+ for dir in '${ELEMENTS_PATH//:/ }'
+ '[' -d /usr/share/diskimage-builder/elements/base ']'
++ find /usr/share/diskimage-builder/elements/base -follow -mindepth 1 -maxdepth 1 -type d -not -name tests
+ for _DIR in '$(find $dir/$_ELEMENT -follow -mindepth 1 -maxdepth 1 -type d -not -name tests)'
+ copy_hooks_not_overwrite /usr/share/diskimage-builder/elements/base/cleanup.d
++ basename /usr/share/diskimage-builder/elements/base/cleanup.d
+ _DIR=cleanup.d
+ test -d /tmp/image.j0k1q4y3/hooks/cleanup.d
++ ls /usr/share/diskimage-builder/elements/base/cleanup.d
+ for _HOOK in '$(ls $1)'
+ '[' '!' -f /tmp/image.j0k1q4y3/hooks/cleanup.d/01-ccache ']'
+ cp -t /tmp/image.j0k1q4y3/hooks/cleanup.d -a /usr/share/diskimage-builder/elements/base/cleanup.d/01-ccache
+ for _HOOK in '$(ls $1)'
+ '[' '!' -f /tmp/image.j0k1q4y3/hooks/cleanup.d/99-tidy-logs ']'
+ cp -t /tmp/image.j0k1q4y3/hooks/cleanup.d -a /usr/share/diskimage-builder/elements/base/cleanup.d/99-tidy-logs
+ for _DIR in '$(find $dir/$_ELEMENT -follow -mindepth 1 -maxdepth 1 -type d -not -name tests)'
+ copy_hooks_not_overwrite /usr/share/diskimage-builder/elements/base/environment.d
++ basename /usr/share/diskimage-builder/elements/base/environment.d
+ _DIR=environment.d
+ test -d /tmp/image.j0k1q4y3/hooks/environment.d
++ ls /usr/share/diskimage-builder/elements/base/environment.d
+ for _HOOK in '$(ls $1)'
+ '[' '!' -f /tmp/image.j0k1q4y3/hooks/environment.d/10-ccache.bash ']'
+ cp -t /tmp/image.j0k1q4y3/hooks/environment.d -a /usr/share/diskimage-builder/elements/base/environment.d/10-ccache.bash
+ for _DIR in '$(find $dir/$_ELEMENT -follow -mindepth 1 -maxdepth 1 -type d -not -name tests)'
+ copy_hooks_not_overwrite /usr/share/diskimage-builder/elements/base/extra-data.d
++ basename /usr/share/diskimage-builder/elements/base/extra-data.d
+ _DIR=extra-data.d
+ test -d /tmp/image.j0k1q4y3/hooks/extra-data.d
++ ls /usr/share/diskimage-builder/elements/base/extra-data.d
+ for _HOOK in '$(ls $1)'
+ '[' '!' -f /tmp/image.j0k1q4y3/hooks/extra-data.d/50-store-build-settings ']'
+ cp -t /tmp/image.j0k1q4y3/hooks/extra-data.d -a /usr/share/diskimage-builder/elements/base/extra-data.d/50-store-build-settings
+ for _DIR in '$(find $dir/$_ELEMENT -follow -mindepth 1 -maxdepth 1 -type d -not -name tests)'
+ copy_hooks_not_overwrite /usr/share/diskimage-builder/elements/base/install.d
++ basename /usr/share/diskimage-builder/elements/base/install.d
+ _DIR=install.d
+ test -d /tmp/image.j0k1q4y3/hooks/install.d
++ ls /usr/share/diskimage-builder/elements/base/install.d
+ for _HOOK in '$(ls $1)'
+ '[' '!' -f /tmp/image.j0k1q4y3/hooks/install.d/00-baseline-environment ']'
+ cp -t /tmp/image.j0k1q4y3/hooks/install.d -a /usr/share/diskimage-builder/elements/base/install.d/00-baseline-environment
+ for _HOOK in '$(ls $1)'
+ '[' '!' -f /tmp/image.j0k1q4y3/hooks/install.d/00-up-to-date ']'
+ cp -t /tmp/image.j0k1q4y3/hooks/install.d -a /usr/share/diskimage-builder/elements/base/install.d/00-up-to-date
+ for _HOOK in '$(ls $1)'
+ '[' '!' -f /tmp/image.j0k1q4y3/hooks/install.d/10-cloud-init ']'
+ cp -t /tmp/image.j0k1q4y3/hooks/install.d -a /usr/share/diskimage-builder/elements/base/install.d/10-cloud-init
+ for _HOOK in '$(ls $1)'
+ '[' '!' -f /tmp/image.j0k1q4y3/hooks/install.d/50-store-build-settings ']'
+ cp -t /tmp/image.j0k1q4y3/hooks/install.d -a /usr/share/diskimage-builder/elements/base/install.d/50-store-build-settings
+ for _HOOK in '$(ls $1)'
+ '[' '!' -f /tmp/image.j0k1q4y3/hooks/install.d/99-dkms ']'
+ cp -t /tmp/image.j0k1q4y3/hooks/install.d -a /usr/share/diskimage-builder/elements/base/install.d/99-dkms
+ for _DIR in '$(find $dir/$_ELEMENT -follow -mindepth 1 -maxdepth 1 -type d -not -name tests)'
+ copy_hooks_not_overwrite /usr/share/diskimage-builder/elements/base/pre-install.d
++ basename /usr/share/diskimage-builder/elements/base/pre-install.d
+ _DIR=pre-install.d
+ test -d /tmp/image.j0k1q4y3/hooks/pre-install.d
++ ls /usr/share/diskimage-builder/elements/base/pre-install.d
+ for _HOOK in '$(ls $1)'
+ '[' '!' -f /tmp/image.j0k1q4y3/hooks/pre-install.d/03-baseline-tools ']'
+ cp -t /tmp/image.j0k1q4y3/hooks/pre-install.d -a /usr/share/diskimage-builder/elements/base/pre-install.d/03-baseline-tools
+ for _DIR in '$(find $dir/$_ELEMENT -follow -mindepth 1 -maxdepth 1 -type d -not -name tests)'
+ copy_hooks_not_overwrite /usr/share/diskimage-builder/elements/base/root.d
++ basename /usr/share/diskimage-builder/elements/base/root.d
+ _DIR=root.d
+ test -d /tmp/image.j0k1q4y3/hooks/root.d
++ ls /usr/share/diskimage-builder/elements/base/root.d
+ for _HOOK in '$(ls $1)'
+ '[' '!' -f /tmp/image.j0k1q4y3/hooks/root.d/01-ccache ']'
+ cp -t /tmp/image.j0k1q4y3/hooks/root.d -a /usr/share/diskimage-builder/elements/base/root.d/01-ccache
++ find /usr/share/diskimage-builder/elements/base -follow -maxdepth 1 -type f
+ for _FILE in '$(find $dir/$_ELEMENT -follow -maxdepth 1 -type f)'
+ cp -t /tmp/image.j0k1q4y3/hooks -a /usr/share/diskimage-builder/elements/base/README.rst
+ for _FILE in '$(find $dir/$_ELEMENT -follow -maxdepth 1 -type f)'
+ cp -t /tmp/image.j0k1q4y3/hooks -a /usr/share/diskimage-builder/elements/base/element-deps
+ for _FILE in '$(find $dir/$_ELEMENT -follow -maxdepth 1 -type f)'
+ cp -t /tmp/image.j0k1q4y3/hooks -a /usr/share/diskimage-builder/elements/base/package-installs.yaml
+ for _FILE in '$(find $dir/$_ELEMENT -follow -maxdepth 1 -type f)'
+ cp -t /tmp/image.j0k1q4y3/hooks -a /usr/share/diskimage-builder/elements/base/pkg-map
+ break
+ for _ELEMENT in '$IMAGE_ELEMENT'
+ for dir in '${ELEMENTS_PATH//:/ }'
+ '[' -d /usr/share/diskimage-builder/elements/selinux-permissive ']'
++ find /usr/share/diskimage-builder/elements/selinux-permissive -follow -mindepth 1 -maxdepth 1 -type d -not -name tests
+ for _DIR in '$(find $dir/$_ELEMENT -follow -mindepth 1 -maxdepth 1 -type d -not -name tests)'
+ copy_hooks_not_overwrite /usr/share/diskimage-builder/elements/selinux-permissive/install.d
++ basename /usr/share/diskimage-builder/elements/selinux-permissive/install.d
+ _DIR=install.d
+ test -d /tmp/image.j0k1q4y3/hooks/install.d
++ ls /usr/share/diskimage-builder/elements/selinux-permissive/install.d
+ for _HOOK in '$(ls $1)'
+ '[' '!' -f /tmp/image.j0k1q4y3/hooks/install.d/11-selinux-permissive ']'
+ cp -t /tmp/image.j0k1q4y3/hooks/install.d -a /usr/share/diskimage-builder/elements/selinux-permissive/install.d/11-selinux-permissive
++ find /usr/share/diskimage-builder/elements/selinux-permissive -follow -maxdepth 1 -type f
+ for _FILE in '$(find $dir/$_ELEMENT -follow -maxdepth 1 -type f)'
+ cp -t /tmp/image.j0k1q4y3/hooks -a /usr/share/diskimage-builder/elements/selinux-permissive/README.rst
+ break
+ for _ELEMENT in '$IMAGE_ELEMENT'
+ for dir in '${ELEMENTS_PATH//:/ }'
+ '[' -d /usr/share/diskimage-builder/elements/yum ']'
++ find /usr/share/diskimage-builder/elements/yum -follow -mindepth 1 -maxdepth 1 -type d -not -name tests
+ for _DIR in '$(find $dir/$_ELEMENT -follow -mindepth 1 -maxdepth 1 -type d -not -name tests)'
+ copy_hooks_not_overwrite /usr/share/diskimage-builder/elements/yum/bin
++ basename /usr/share/diskimage-builder/elements/yum/bin
+ _DIR=bin
+ test -d /tmp/image.j0k1q4y3/hooks/bin
++ ls /usr/share/diskimage-builder/elements/yum/bin
+ for _HOOK in '$(ls $1)'
+ '[' '!' -f /tmp/image.j0k1q4y3/hooks/bin/install-packages ']'
+ cp -t /tmp/image.j0k1q4y3/hooks/bin -a /usr/share/diskimage-builder/elements/yum/bin/install-packages
+ for _DIR in '$(find $dir/$_ELEMENT -follow -mindepth 1 -maxdepth 1 -type d -not -name tests)'
+ copy_hooks_not_overwrite /usr/share/diskimage-builder/elements/yum/cleanup.d
++ basename /usr/share/diskimage-builder/elements/yum/cleanup.d
+ _DIR=cleanup.d
+ test -d /tmp/image.j0k1q4y3/hooks/cleanup.d
++ ls /usr/share/diskimage-builder/elements/yum/cleanup.d
+ for _HOOK in '$(ls $1)'
+ '[' '!' -f /tmp/image.j0k1q4y3/hooks/cleanup.d/99-remove-yum-repo-conf ']'
+ cp -t /tmp/image.j0k1q4y3/hooks/cleanup.d -a /usr/share/diskimage-builder/elements/yum/cleanup.d/99-remove-yum-repo-conf
+ for _DIR in '$(find $dir/$_ELEMENT -follow -mindepth 1 -maxdepth 1 -type d -not -name tests)'
+ copy_hooks_not_overwrite /usr/share/diskimage-builder/elements/yum/extra-data.d
++ basename /usr/share/diskimage-builder/elements/yum/extra-data.d
+ _DIR=extra-data.d
+ test -d /tmp/image.j0k1q4y3/hooks/extra-data.d
++ ls /usr/share/diskimage-builder/elements/yum/extra-data.d
+ for _HOOK in '$(ls $1)'
+ '[' '!' -f /tmp/image.j0k1q4y3/hooks/extra-data.d/99-yum-repo-conf ']'
+ cp -t /tmp/image.j0k1q4y3/hooks/extra-data.d -a /usr/share/diskimage-builder/elements/yum/extra-data.d/99-yum-repo-conf
+ for _DIR in '$(find $dir/$_ELEMENT -follow -mindepth 1 -maxdepth 1 -type d -not -name tests)'
+ copy_hooks_not_overwrite /usr/share/diskimage-builder/elements/yum/post-install.d
++ basename /usr/share/diskimage-builder/elements/yum/post-install.d
+ _DIR=post-install.d
+ test -d /tmp/image.j0k1q4y3/hooks/post-install.d
++ ls /usr/share/diskimage-builder/elements/yum/post-install.d
+ for _HOOK in '$(ls $1)'
+ '[' '!' -f /tmp/image.j0k1q4y3/hooks/post-install.d/99-reset-yum-conf ']'
+ cp -t /tmp/image.j0k1q4y3/hooks/post-install.d -a /usr/share/diskimage-builder/elements/yum/post-install.d/99-reset-yum-conf
+ for _DIR in '$(find $dir/$_ELEMENT -follow -mindepth 1 -maxdepth 1 -type d -not -name tests)'
+ copy_hooks_not_overwrite /usr/share/diskimage-builder/elements/yum/pre-install.d
++ basename /usr/share/diskimage-builder/elements/yum/pre-install.d
+ _DIR=pre-install.d
+ test -d /tmp/image.j0k1q4y3/hooks/pre-install.d
++ ls /usr/share/diskimage-builder/elements/yum/pre-install.d
+ for _HOOK in '$(ls $1)'
+ '[' '!' -f /tmp/image.j0k1q4y3/hooks/pre-install.d/00-dnf-update ']'
+ cp -t /tmp/image.j0k1q4y3/hooks/pre-install.d -a /usr/share/diskimage-builder/elements/yum/pre-install.d/00-dnf-update
+ for _HOOK in '$(ls $1)'
+ '[' '!' -f /tmp/image.j0k1q4y3/hooks/pre-install.d/01-yum-install-bin ']'
+ cp -t /tmp/image.j0k1q4y3/hooks/pre-install.d -a /usr/share/diskimage-builder/elements/yum/pre-install.d/01-yum-install-bin
+ for _HOOK in '$(ls $1)'
+ '[' '!' -f /tmp/image.j0k1q4y3/hooks/pre-install.d/01-yum-keepcache ']'
+ cp -t /tmp/image.j0k1q4y3/hooks/pre-install.d -a /usr/share/diskimage-builder/elements/yum/pre-install.d/01-yum-keepcache
+ for _DIR in '$(find $dir/$_ELEMENT -follow -mindepth 1 -maxdepth 1 -type d -not -name tests)'
+ copy_hooks_not_overwrite /usr/share/diskimage-builder/elements/yum/root.d
++ basename /usr/share/diskimage-builder/elements/yum/root.d
+ _DIR=root.d
+ test -d /tmp/image.j0k1q4y3/hooks/root.d
++ ls /usr/share/diskimage-builder/elements/yum/root.d
+ for _HOOK in '$(ls $1)'
+ '[' '!' -f /tmp/image.j0k1q4y3/hooks/root.d/50-yum-cache ']'
+ cp -t /tmp/image.j0k1q4y3/hooks/root.d -a /usr/share/diskimage-builder/elements/yum/root.d/50-yum-cache
++ find /usr/share/diskimage-builder/elements/yum -follow -maxdepth 1 -type f
+ for _FILE in '$(find $dir/$_ELEMENT -follow -maxdepth 1 -type f)'
+ cp -t /tmp/image.j0k1q4y3/hooks -a /usr/share/diskimage-builder/elements/yum/README.rst
+ break
+ for _ELEMENT in '$IMAGE_ELEMENT'
+ for dir in '${ELEMENTS_PATH//:/ }'
+ '[' -d /usr/share/diskimage-builder/elements/dib-init-system ']'
++ find /usr/share/diskimage-builder/elements/dib-init-system -follow -mindepth 1 -maxdepth 1 -type d -not -name tests
+ for _DIR in '$(find $dir/$_ELEMENT -follow -mindepth 1 -maxdepth 1 -type d -not -name tests)'
+ copy_hooks_not_overwrite /usr/share/diskimage-builder/elements/dib-init-system/environment.d
++ basename /usr/share/diskimage-builder/elements/dib-init-system/environment.d
+ _DIR=environment.d
+ test -d /tmp/image.j0k1q4y3/hooks/environment.d
++ ls /usr/share/diskimage-builder/elements/dib-init-system/environment.d
+ for _HOOK in '$(ls $1)'
+ '[' '!' -f /tmp/image.j0k1q4y3/hooks/environment.d/10-dib-init-system.bash ']'
+ cp -t /tmp/image.j0k1q4y3/hooks/environment.d -a /usr/share/diskimage-builder/elements/dib-init-system/environment.d/10-dib-init-system.bash
+ for _DIR in '$(find $dir/$_ELEMENT -follow -mindepth 1 -maxdepth 1 -type d -not -name tests)'
+ copy_hooks_not_overwrite /usr/share/diskimage-builder/elements/dib-init-system/install.d
++ basename /usr/share/diskimage-builder/elements/dib-init-system/install.d
+ _DIR=install.d
+ test -d /tmp/image.j0k1q4y3/hooks/install.d
++ ls /usr/share/diskimage-builder/elements/dib-init-system/install.d
+ for _HOOK in '$(ls $1)'
+ '[' '!' -f /tmp/image.j0k1q4y3/hooks/install.d/20-install-init-scripts ']'
+ cp -t /tmp/image.j0k1q4y3/hooks/install.d -a /usr/share/diskimage-builder/elements/dib-init-system/install.d/20-install-init-scripts
+ for _DIR in '$(find $dir/$_ELEMENT -follow -mindepth 1 -maxdepth 1 -type d -not -name tests)'
+ copy_hooks_not_overwrite /usr/share/diskimage-builder/elements/dib-init-system/pre-install.d
++ basename /usr/share/diskimage-builder/elements/dib-init-system/pre-install.d
+ _DIR=pre-install.d
+ test -d /tmp/image.j0k1q4y3/hooks/pre-install.d
++ ls /usr/share/diskimage-builder/elements/dib-init-system/pre-install.d
+ for _HOOK in '$(ls $1)'
+ '[' '!' -f /tmp/image.j0k1q4y3/hooks/pre-install.d/04-dib-init-system ']'
+ cp -t /tmp/image.j0k1q4y3/hooks/pre-install.d -a /usr/share/diskimage-builder/elements/dib-init-system/pre-install.d/04-dib-init-system
++ find /usr/share/diskimage-builder/elements/dib-init-system -follow -maxdepth 1 -type f
+ for _FILE in '$(find $dir/$_ELEMENT -follow -maxdepth 1 -type f)'
+ cp -t /tmp/image.j0k1q4y3/hooks -a /usr/share/diskimage-builder/elements/dib-init-system/README.rst
+ for _FILE in '$(find $dir/$_ELEMENT -follow -maxdepth 1 -type f)'
+ cp -t /tmp/image.j0k1q4y3/hooks -a /usr/share/diskimage-builder/elements/dib-init-system/dib-init-system
+ break
+ for _ELEMENT in '$IMAGE_ELEMENT'
+ for dir in '${ELEMENTS_PATH//:/ }'
+ '[' -d /usr/share/diskimage-builder/elements/cloud-init-datasources ']'
++ find /usr/share/diskimage-builder/elements/cloud-init-datasources -follow -mindepth 1 -maxdepth 1 -type d -not -name tests
+ for _DIR in '$(find $dir/$_ELEMENT -follow -mindepth 1 -maxdepth 1 -type d -not -name tests)'
+ copy_hooks_not_overwrite /usr/share/diskimage-builder/elements/cloud-init-datasources/install.d
++ basename /usr/share/diskimage-builder/elements/cloud-init-datasources/install.d
+ _DIR=install.d
+ test -d /tmp/image.j0k1q4y3/hooks/install.d
++ ls /usr/share/diskimage-builder/elements/cloud-init-datasources/install.d
+ for _HOOK in '$(ls $1)'
+ '[' '!' -f /tmp/image.j0k1q4y3/hooks/install.d/05-set-cloud-init-sources ']'
+ cp -t /tmp/image.j0k1q4y3/hooks/install.d -a /usr/share/diskimage-builder/elements/cloud-init-datasources/install.d/05-set-cloud-init-sources
++ find /usr/share/diskimage-builder/elements/cloud-init-datasources -follow -maxdepth 1 -type f
+ for _FILE in '$(find $dir/$_ELEMENT -follow -maxdepth 1 -type f)'
+ cp -t /tmp/image.j0k1q4y3/hooks -a /usr/share/diskimage-builder/elements/cloud-init-datasources/README.rst
+ break
+ for _ELEMENT in '$IMAGE_ELEMENT'
+ for dir in '${ELEMENTS_PATH//:/ }'
+ '[' -d /usr/share/diskimage-builder/elements/trove-guest ']'
+ continue
+ for dir in '${ELEMENTS_PATH//:/ }'
+ '[' -d ./elements/trove-guest ']'
++ find ./elements/trove-guest -follow -mindepth 1 -maxdepth 1 -type d -not -name tests
+ for _DIR in '$(find $dir/$_ELEMENT -follow -mindepth 1 -maxdepth 1 -type d -not -name tests)'
+ copy_hooks_not_overwrite ./elements/trove-guest/install.d
++ basename ./elements/trove-guest/install.d
+ _DIR=install.d
+ test -d /tmp/image.j0k1q4y3/hooks/install.d
++ ls ./elements/trove-guest/install.d
+ for _HOOK in '$(ls $1)'
+ '[' '!' -f /tmp/image.j0k1q4y3/hooks/install.d/15-install-trove ']'
+ cp -t /tmp/image.j0k1q4y3/hooks/install.d -a ./elements/trove-guest/install.d/15-install-trove
+ for _DIR in '$(find $dir/$_ELEMENT -follow -mindepth 1 -maxdepth 1 -type d -not -name tests)'
+ copy_hooks_not_overwrite ./elements/trove-guest/post-install.d
++ basename ./elements/trove-guest/post-install.d
+ _DIR=post-install.d
+ test -d /tmp/image.j0k1q4y3/hooks/post-install.d
++ ls ./elements/trove-guest/post-install.d
+ for _HOOK in '$(ls $1)'
+ '[' '!' -f /tmp/image.j0k1q4y3/hooks/post-install.d/30-register-guest-service ']'
+ cp -t /tmp/image.j0k1q4y3/hooks/post-install.d -a ./elements/trove-guest/post-install.d/30-register-guest-service
++ find ./elements/trove-guest -follow -maxdepth 1 -type f
+ for _FILE in '$(find $dir/$_ELEMENT -follow -maxdepth 1 -type f)'
+ cp -t /tmp/image.j0k1q4y3/hooks -a ./elements/trove-guest/openstack-trove-guestagent.service
+ break
+ for _ELEMENT in '$IMAGE_ELEMENT'
+ for dir in '${ELEMENTS_PATH//:/ }'
+ '[' -d /usr/share/diskimage-builder/elements/source-repositories ']'
++ find /usr/share/diskimage-builder/elements/source-repositories -follow -mindepth 1 -maxdepth 1 -type d -not -name tests
+ for _DIR in '$(find $dir/$_ELEMENT -follow -mindepth 1 -maxdepth 1 -type d -not -name tests)'
+ copy_hooks_not_overwrite /usr/share/diskimage-builder/elements/source-repositories/extra-data.d
++ basename /usr/share/diskimage-builder/elements/source-repositories/extra-data.d
+ _DIR=extra-data.d
+ test -d /tmp/image.j0k1q4y3/hooks/extra-data.d
++ ls /usr/share/diskimage-builder/elements/source-repositories/extra-data.d
+ for _HOOK in '$(ls $1)'
+ '[' '!' -f /tmp/image.j0k1q4y3/hooks/extra-data.d/98-source-repositories ']'
+ cp -t /tmp/image.j0k1q4y3/hooks/extra-data.d -a /usr/share/diskimage-builder/elements/source-repositories/extra-data.d/98-source-repositories
++ find /usr/share/diskimage-builder/elements/source-repositories -follow -maxdepth 1 -type f
+ for _FILE in '$(find $dir/$_ELEMENT -follow -maxdepth 1 -type f)'
+ cp -t /tmp/image.j0k1q4y3/hooks -a /usr/share/diskimage-builder/elements/source-repositories/README.rst
+ for _FILE in '$(find $dir/$_ELEMENT -follow -maxdepth 1 -type f)'
+ cp -t /tmp/image.j0k1q4y3/hooks -a /usr/share/diskimage-builder/elements/source-repositories/element-deps
+ for _FILE in '$(find $dir/$_ELEMENT -follow -maxdepth 1 -type f)'
+ cp -t /tmp/image.j0k1q4y3/hooks -a /usr/share/diskimage-builder/elements/source-repositories/package-installs.yaml
+ break
+ for _ELEMENT in '$IMAGE_ELEMENT'
+ for dir in '${ELEMENTS_PATH//:/ }'
+ '[' -d /usr/share/diskimage-builder/elements/package-installs ']'
++ find /usr/share/diskimage-builder/elements/package-installs -follow -mindepth 1 -maxdepth 1 -type d -not -name tests
+ for _DIR in '$(find $dir/$_ELEMENT -follow -mindepth 1 -maxdepth 1 -type d -not -name tests)'
+ copy_hooks_not_overwrite /usr/share/diskimage-builder/elements/package-installs/bin
++ basename /usr/share/diskimage-builder/elements/package-installs/bin
+ _DIR=bin
+ test -d /tmp/image.j0k1q4y3/hooks/bin
++ ls /usr/share/diskimage-builder/elements/package-installs/bin
+ for _HOOK in '$(ls $1)'
+ '[' '!' -f /tmp/image.j0k1q4y3/hooks/bin/package-installs ']'
+ cp -t /tmp/image.j0k1q4y3/hooks/bin -a /usr/share/diskimage-builder/elements/package-installs/bin/package-installs
+ for _HOOK in '$(ls $1)'
+ '[' '!' -f /tmp/image.j0k1q4y3/hooks/bin/package-installs-squash ']'
+ cp -t /tmp/image.j0k1q4y3/hooks/bin -a /usr/share/diskimage-builder/elements/package-installs/bin/package-installs-squash
+ for _HOOK in '$(ls $1)'
+ '[' '!' -f /tmp/image.j0k1q4y3/hooks/bin/package-installs-v2 ']'
+ cp -t /tmp/image.j0k1q4y3/hooks/bin -a /usr/share/diskimage-builder/elements/package-installs/bin/package-installs-v2
+ for _HOOK in '$(ls $1)'
+ '[' '!' -f /tmp/image.j0k1q4y3/hooks/bin/package-uninstalls ']'
+ cp -t /tmp/image.j0k1q4y3/hooks/bin -a /usr/share/diskimage-builder/elements/package-installs/bin/package-uninstalls
+ for _DIR in '$(find $dir/$_ELEMENT -follow -mindepth 1 -maxdepth 1 -type d -not -name tests)'
+ copy_hooks_not_overwrite /usr/share/diskimage-builder/elements/package-installs/extra-data.d
++ basename /usr/share/diskimage-builder/elements/package-installs/extra-data.d
+ _DIR=extra-data.d
+ test -d /tmp/image.j0k1q4y3/hooks/extra-data.d
++ ls /usr/share/diskimage-builder/elements/package-installs/extra-data.d
+ for _HOOK in '$(ls $1)'
+ '[' '!' -f /tmp/image.j0k1q4y3/hooks/extra-data.d/99-squash-package-install ']'
+ cp -t /tmp/image.j0k1q4y3/hooks/extra-data.d -a /usr/share/diskimage-builder/elements/package-installs/extra-data.d/99-squash-package-install
+ for _DIR in '$(find $dir/$_ELEMENT -follow -mindepth 1 -maxdepth 1 -type d -not -name tests)'
+ copy_hooks_not_overwrite /usr/share/diskimage-builder/elements/package-installs/install.d
++ basename /usr/share/diskimage-builder/elements/package-installs/install.d
+ _DIR=install.d
+ test -d /tmp/image.j0k1q4y3/hooks/install.d
++ ls /usr/share/diskimage-builder/elements/package-installs/install.d
+ for _HOOK in '$(ls $1)'
+ '[' '!' -f /tmp/image.j0k1q4y3/hooks/install.d/01-package-installs ']'
+ cp -t /tmp/image.j0k1q4y3/hooks/install.d -a /usr/share/diskimage-builder/elements/package-installs/install.d/01-package-installs
+ for _HOOK in '$(ls $1)'
+ '[' '!' -f /tmp/image.j0k1q4y3/hooks/install.d/99-package-uninstalls ']'
+ cp -t /tmp/image.j0k1q4y3/hooks/install.d -a /usr/share/diskimage-builder/elements/package-installs/install.d/99-package-uninstalls
+ for _DIR in '$(find $dir/$_ELEMENT -follow -mindepth 1 -maxdepth 1 -type d -not -name tests)'
+ copy_hooks_not_overwrite /usr/share/diskimage-builder/elements/package-installs/post-install.d
++ basename /usr/share/diskimage-builder/elements/package-installs/post-install.d
+ _DIR=post-install.d
+ test -d /tmp/image.j0k1q4y3/hooks/post-install.d
++ ls /usr/share/diskimage-builder/elements/package-installs/post-install.d
+ for _HOOK in '$(ls $1)'
+ '[' '!' -f /tmp/image.j0k1q4y3/hooks/post-install.d/00-package-installs ']'
+ cp -t /tmp/image.j0k1q4y3/hooks/post-install.d -a /usr/share/diskimage-builder/elements/package-installs/post-install.d/00-package-installs
+ for _HOOK in '$(ls $1)'
+ '[' '!' -f /tmp/image.j0k1q4y3/hooks/post-install.d/99-package-uninstalls ']'
+ cp -t /tmp/image.j0k1q4y3/hooks/post-install.d -a /usr/share/diskimage-builder/elements/package-installs/post-install.d/99-package-uninstalls
+ for _DIR in '$(find $dir/$_ELEMENT -follow -mindepth 1 -maxdepth 1 -type d -not -name tests)'
+ copy_hooks_not_overwrite /usr/share/diskimage-builder/elements/package-installs/pre-install.d
++ basename /usr/share/diskimage-builder/elements/package-installs/pre-install.d
+ _DIR=pre-install.d
+ test -d /tmp/image.j0k1q4y3/hooks/pre-install.d
++ ls /usr/share/diskimage-builder/elements/package-installs/pre-install.d
+ for _HOOK in '$(ls $1)'
+ '[' '!' -f /tmp/image.j0k1q4y3/hooks/pre-install.d/02-package-installs ']'
+ cp -t /tmp/image.j0k1q4y3/hooks/pre-install.d -a /usr/share/diskimage-builder/elements/package-installs/pre-install.d/02-package-installs
+ for _HOOK in '$(ls $1)'
+ '[' '!' -f /tmp/image.j0k1q4y3/hooks/pre-install.d/99-package-uninstalls ']'
+ cp -t /tmp/image.j0k1q4y3/hooks/pre-install.d -a /usr/share/diskimage-builder/elements/package-installs/pre-install.d/99-package-uninstalls
++ find /usr/share/diskimage-builder/elements/package-installs -follow -maxdepth 1 -type f
+ for _FILE in '$(find $dir/$_ELEMENT -follow -maxdepth 1 -type f)'
+ cp -t /tmp/image.j0k1q4y3/hooks -a /usr/share/diskimage-builder/elements/package-installs/README.rst
+ for _FILE in '$(find $dir/$_ELEMENT -follow -maxdepth 1 -type f)'
+ cp -t /tmp/image.j0k1q4y3/hooks -a /usr/share/diskimage-builder/elements/package-installs/element-deps
+ break
+ for _ELEMENT in '$IMAGE_ELEMENT'
+ for dir in '${ELEMENTS_PATH//:/ }'
+ '[' -d /usr/share/diskimage-builder/elements/system-configuration ']'
+ continue
+ for dir in '${ELEMENTS_PATH//:/ }'
+ '[' -d ./elements/system-configuration ']'
++ find ./elements/system-configuration -follow -mindepth 1 -maxdepth 1 -type d -not -name tests
+ for _DIR in '$(find $dir/$_ELEMENT -follow -mindepth 1 -maxdepth 1 -type d -not -name tests)'
+ copy_hooks_not_overwrite ./elements/system-configuration/finalise.d
++ basename ./elements/system-configuration/finalise.d
+ _DIR=finalise.d
+ test -d /tmp/image.j0k1q4y3/hooks/finalise.d
++ ls ./elements/system-configuration/finalise.d
+ for _HOOK in '$(ls $1)'
+ '[' '!' -f /tmp/image.j0k1q4y3/hooks/finalise.d/60-set-no-timer-check ']'
+ cp -t /tmp/image.j0k1q4y3/hooks/finalise.d -a ./elements/system-configuration/finalise.d/60-set-no-timer-check
+ for _DIR in '$(find $dir/$_ELEMENT -follow -mindepth 1 -maxdepth 1 -type d -not -name tests)'
+ copy_hooks_not_overwrite ./elements/system-configuration/install.d
++ basename ./elements/system-configuration/install.d
+ _DIR=install.d
+ test -d /tmp/image.j0k1q4y3/hooks/install.d
++ ls ./elements/system-configuration/install.d
+ for _HOOK in '$(ls $1)'
+ '[' '!' -f /tmp/image.j0k1q4y3/hooks/install.d/01-user ']'
+ cp -t /tmp/image.j0k1q4y3/hooks/install.d -a ./elements/system-configuration/install.d/01-user
+ for _DIR in '$(find $dir/$_ELEMENT -follow -mindepth 1 -maxdepth 1 -type d -not -name tests)'
+ copy_hooks_not_overwrite ./elements/system-configuration/post-install.d
++ basename ./elements/system-configuration/post-install.d
+ _DIR=post-install.d
+ test -d /tmp/image.j0k1q4y3/hooks/post-install.d
++ ls ./elements/system-configuration/post-install.d
+ for _HOOK in '$(ls $1)'
+ '[' '!' -f /tmp/image.j0k1q4y3/hooks/post-install.d/10-ntp ']'
+ cp -t /tmp/image.j0k1q4y3/hooks/post-install.d -a ./elements/system-configuration/post-install.d/10-ntp
+ for _HOOK in '$(ls $1)'
+ '[' '!' -f /tmp/image.j0k1q4y3/hooks/post-install.d/20-ssh ']'
+ cp -t /tmp/image.j0k1q4y3/hooks/post-install.d -a ./elements/system-configuration/post-install.d/20-ssh
+ for _HOOK in '$(ls $1)'
+ '[' '!' -f /tmp/image.j0k1q4y3/hooks/post-install.d/62-trove-guest-sudoers ']'
+ cp -t /tmp/image.j0k1q4y3/hooks/post-install.d -a ./elements/system-configuration/post-install.d/62-trove-guest-sudoers
+ for _HOOK in '$(ls $1)'
+ '[' '!' -f /tmp/image.j0k1q4y3/hooks/post-install.d/90-yum-update ']'
+ cp -t /tmp/image.j0k1q4y3/hooks/post-install.d -a ./elements/system-configuration/post-install.d/90-yum-update
++ find ./elements/system-configuration -follow -maxdepth 1 -type f
+ break
+ check_break before-root bash
+ echo ''
+ egrep -e '(,|^)before-root(,|$)' -q
+ '[' -d /tmp/image.j0k1q4y3/hooks/root.d ']'
+ dib-run-parts /tmp/image.j0k1q4y3/hooks/root.d
+ set -eu
+ set -o pipefail
+ '[' -f /sbin/initctl ']'
+ '[' -f /usr/bin/systemctl ']'
+ echo systemd
++ set -eu
++ set -o pipefail
++ export DIB_MANIFEST_IMAGE_DIR=/etc/dib-manifests
++ DIB_MANIFEST_IMAGE_DIR=/etc/dib-manifests
++ export DIB_MANIFEST_SAVE_DIR=centos-mysql-guest-image.d/
++ DIB_MANIFEST_SAVE_DIR=centos-mysql-guest-image.d/
+ for target in '$targets'
+ output 'Running /tmp/image.j0k1q4y3/hooks/root.d/01-ccache'
++ date
+ echo dib-run-parts Thu Jan 14 11:28:12 UTC 2016 Running /tmp/image.j0k1q4y3/hooks/root.d/01-ccache
dib-run-parts Thu Jan 14 11:28:12 UTC 2016 Running /tmp/image.j0k1q4y3/hooks/root.d/01-ccache
+ target_tag=01-ccache
+ date +%s.%N
+ /tmp/image.j0k1q4y3/hooks/root.d/01-ccache
+ set -eu
+ set -o pipefail
+ grep ' /tmp/image.j0k1q4y3/mnt/tmp/ccache' /proc/mounts
+ DIB_CCACHE_DIR=/root/.cache/image-create/ccache
+ mkdir -p /root/.cache/image-create/ccache
+ sudo mkdir -p /tmp/image.j0k1q4y3/mnt/tmp/ccache
+ sudo mount --bind /root/.cache/image-create/ccache /tmp/image.j0k1q4y3/mnt/tmp/ccache
+ target_tag=01-ccache
+ date +%s.%N
+ output '01-ccache completed'
++ date
+ echo dib-run-parts Thu Jan 14 11:28:12 UTC 2016 01-ccache completed
dib-run-parts Thu Jan 14 11:28:12 UTC 2016 01-ccache completed
+ for target in '$targets'
+ output 'Running /tmp/image.j0k1q4y3/hooks/root.d/10-centos7-cloud-image'
++ date
+ echo dib-run-parts Thu Jan 14 11:28:12 UTC 2016 Running /tmp/image.j0k1q4y3/hooks/root.d/10-centos7-cloud-image
dib-run-parts Thu Jan 14 11:28:12 UTC 2016 Running /tmp/image.j0k1q4y3/hooks/root.d/10-centos7-cloud-image
+ target_tag=10-centos7-cloud-image
+ date +%s.%N
+ /tmp/image.j0k1q4y3/hooks/root.d/10-centos7-cloud-image
+ set -eu
+ set -o pipefail
+ '[' -n amd64 ']'
+ '[' -n /tmp/image.j0k1q4y3/mnt ']'
+ '[' amd64 = amd64 ']'
+ ARCH=x86_64
+ DIB_LOCAL_IMAGE=
+ '[' -n '' ']'
+ DIB_RELEASE=GenericCloud
+ DIB_CLOUD_IMAGES=http://cloud.centos.org/centos/7/images
+ BASE_IMAGE_FILE=CentOS-7-x86_64-GenericCloud.qcow2.xz
+ BASE_IMAGE_TAR=CentOS-7-x86_64-GenericCloud.qcow2.xz.tgz
+ IMAGE_LOCATION=http://cloud.centos.org/centos/7/images/CentOS-7-x86_64-GenericCloud.qcow2.xz
+ CACHED_IMAGE=/root/.cache/image-create/CentOS-7-x86_64-GenericCloud.qcow2.xz
+ /tmp/image.j0k1q4y3/hooks/bin/extract-image CentOS-7-x86_64-GenericCloud.qcow2.xz CentOS-7-x86_64-GenericCloud.qcow2.xz.tgz http://cloud.centos.org/centos/7/images/CentOS-7-x86_64-GenericCloud.qcow2.xz /root/.cache/image-create/CentOS-7-x86_64-GenericCloud.qcow2.xz
+ set -eu
+ set -o pipefail
+ BASE_IMAGE_FILE=CentOS-7-x86_64-GenericCloud.qcow2.xz
+ BASE_IMAGE_TAR=CentOS-7-x86_64-GenericCloud.qcow2.xz.tgz
+ IMAGE_LOCATION=http://cloud.centos.org/centos/7/images/CentOS-7-x86_64-GenericCloud.qcow2.xz
+ CACHED_IMAGE=/root/.cache/image-create/CentOS-7-x86_64-GenericCloud.qcow2.xz
+ CACHED_TAR=/root/.cache/image-create/CentOS-7-x86_64-GenericCloud.qcow2.xz.tgz
+ DIB_LOCAL_IMAGE=
+ TAR_LOCK=/root/.cache/image-create/CentOS-7-x86_64-GenericCloud.qcow2.xz.tgz.lock
++ date
+ echo 'Getting /root/.cache/image-create/CentOS-7-x86_64-GenericCloud.qcow2.xz.tgz.lock: Thu Jan 14 11:28:12 UTC 2016'
Getting /root/.cache/image-create/CentOS-7-x86_64-GenericCloud.qcow2.xz.tgz.lock: Thu Jan 14 11:28:12 UTC 2016
+ flock -w 1200 9
+ extract_image
+ '[' -n '' -a -f /root/.cache/image-create/CentOS-7-x86_64-GenericCloud.qcow2.xz.tgz ']'
+ '[' -z '' ']'
+ echo 'Fetching Base Image'
Fetching Base Image
+ set +e
+ /tmp/image.j0k1q4y3/hooks/bin/cache-url http://cloud.centos.org/centos/7/images/CentOS-7-x86_64-GenericCloud.qcow2.xz /root/.cache/image-create/CentOS-7-x86_64-GenericCloud.qcow2.xz
+ set -eu
+ set -o pipefail
++ basename /tmp/image.j0k1q4y3/hooks/bin/cache-url
+ SCRIPT_NAME=cache-url
++ dirname /tmp/image.j0k1q4y3/hooks/bin/cache-url
+ SCRIPT_HOME=/tmp/image.j0k1q4y3/hooks/bin
+ FORCE_REVALIDATE=0
++ getopt -o hf -n cache-url -- http://cloud.centos.org/centos/7/images/CentOS-7-x86_64-GenericCloud.qcow2.xz /root/.cache/image-create/CentOS-7-x86_64-GenericCloud.qcow2.xz
+ TEMP=' -- '\''http://cloud.centos.org/centos/7/images/CentOS-7-x86_64-GenericCloud.qcow2.xz'\'' '\''/root/.cache/image-create/CentOS-7-x86_64-GenericCloud.qcow2.xz'\'''
+ '[' 0 '!=' 0 ']'
+ eval set -- ' -- '\''http://cloud.centos.org/centos/7/images/CentOS-7-x86_64-GenericCloud.qcow2.xz'\'' '\''/root/.cache/image-create/CentOS-7-x86_64-GenericCloud.qcow2.xz'\'''
++ set -- -- http://cloud.centos.org/centos/7/images/CentOS-7-x86_64-GenericCloud.qcow2.xz /root/.cache/image-create/CentOS-7-x86_64-GenericCloud.qcow2.xz
+ true
+ case "$1" in
+ shift
+ break
+ url=http://cloud.centos.org/centos/7/images/CentOS-7-x86_64-GenericCloud.qcow2.xz
+ dest=/root/.cache/image-create/CentOS-7-x86_64-GenericCloud.qcow2.xz
+ time_cond=
+ curl_opts=
+ '[' -z http://cloud.centos.org/centos/7/images/CentOS-7-x86_64-GenericCloud.qcow2.xz -o -z /root/.cache/image-create/CentOS-7-x86_64-GenericCloud.qcow2.xz ']'
+ '[' -p /root/.cache/image-create/CentOS-7-x86_64-GenericCloud.qcow2.xz ']'
+ type=normal
++ dirname /root/.cache/image-create/CentOS-7-x86_64-GenericCloud.qcow2.xz
+ mkdir -p /root/.cache/image-create
+++ dirname /root/.cache/image-create/CentOS-7-x86_64-GenericCloud.qcow2.xz
++ mktemp /root/.cache/image-create/.download.XXXXXXXX
+ tmp=/root/.cache/image-create/.download.vSTIyi7K
+ '[' 0 = 1 ']'
+ '[' -f /root/.cache/image-create/CentOS-7-x86_64-GenericCloud.qcow2.xz -a -s /root/.cache/image-create/CentOS-7-x86_64-GenericCloud.qcow2.xz ']'
+ success='Downloaded and cached http://cloud.centos.org/centos/7/images/CentOS-7-x86_64-GenericCloud.qcow2.xz for the first time'
++ eval curl -v -L -o /root/.cache/image-create/.download.vSTIyi7K -w '%{http_code}' http://cloud.centos.org/centos/7/images/CentOS-7-x86_64-GenericCloud.qcow2.xz
+++ curl -v -L -o /root/.cache/image-create/.download.vSTIyi7K -w '%{http_code}' http://cloud.centos.org/centos/7/images/CentOS-7-x86_64-GenericCloud.qcow2.xz
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0* About to connect() to cloud.centos.org port 80 (#0)
*   Trying 65.182.107.60...
  0     0    0     0    0     0      0      0 --:--:--  0:00:01 --:--:--     0* Connected to cloud.centos.org (65.182.107.60) port 80 (#0)
> GET /centos/7/images/CentOS-7-x86_64-GenericCloud.qcow2.xz HTTP/1.1
> User-Agent: curl/7.29.0
> Host: cloud.centos.org
> Accept: */*
> 
  0     0    0     0    0     0      0      0 --:--:--  0:00:02 --:--:--     0< HTTP/1.1 200 OK
< Date: Thu, 14 Jan 2016 11:28:13 GMT
< Server: Apache/2.2.15 (CentOS)
< Last-Modified: Thu, 17 Dec 2015 17:37:04 GMT
< ETag: "a20151-ee6f260-5271b78923000"
< Accept-Ranges: bytes
< Content-Length: 250016352
< Connection: close
< Content-Type: application/x-xz
< 
{ [data not shown]
  0  238M    0 66928    0     0  22184      0  3:07:50  0:00:03  3:07:47 22190  0  238M    0  273k    0     0  70770      0  0:58:52  0:00:03  0:58:49 70754  0  238M    0  555k    0     0   109k      0  0:37:15  0:00:05  0:37:10  109k  0  238M    0  802k    0     0   132k      0  0:30:36  0:00:06  0:30:30  177k  0  238M    0  870k    0     0   116k      0  0:34:49  0:00:07  0:34:42  176k  0  238M    0  870k    0     0   103k      0  0:39:30  0:00:08  0:39:22  148k  0  238M    0  870k    0     0  94310      0  0:44:11  0:00:09  0:44:02  108k  0  238M    0  870k    0     0  85277      0  0:48:51  0:00:10  0:48:41 60102  0  238M    0  870k    0     0  77823      0  0:53:32  0:00:11  0:53:21 12852  0  238M    0  870k    0     0  71567      0  0:58:13  0:00:12  0:58:01     0  0  238M    0  870k    0     0  66243      0  1:02:54  0:00:13  1:02:41     0  0  238M    0  870k    0     0  61655      0  1:07:35  0:00:14  1:07:21     0  0  238M    0  870k    0     0  57662      0  1:12:15  0:00:15  1:12:00     0  0  238M    0  870k    0     0  54155      0  1:16:56  0:00:16  1:16:40     0  0  238M    0  870k    0     0  51050      0  1:21:37  0:00:17  1:21:20     0  0  238M    0  870k    0     0  48281      0  1:26:18  0:00:18  1:26:00     0  0  238M    0  870k    0     0  45797      0  1:30:59  0:00:19  1:30:40     0  0  238M    0  870k    0     0  43557      0  1:35:39  0:00:20  1:35:19     0  0  238M    0  870k    0     0  41525      0  1:40:20  0:00:21  1:39:59     0  0  238M    0  870k    0     0  39675      0  1:45:01  0:00:22  1:44:39     0  0  238M    0  870k    0     0  37982      0  1:49:42  0:00:23  1:49:19     0  0  238M    0  870k    0     0  36428      0  1:54:23  0:00:24  1:53:59     0  0  238M    0  870k    0     0  34996      0  1:59:04  0:00:25  1:58:39     0  0  238M    0  870k    0     0  33673      0  2:03:44  0:00:26  2:03:18     0  0  238M    0  870k    0     0  32446      0  2:08:25  0:00:27  2:07:58     0  0  238M    0  870k    0     0  31305      0  2:13:06  0:00:28  2:12:38     0  0  238M    0  870k    0     0  30241      0  2:17:47  0:00:29  2:17:18     0  0  238M    0  870k    0     0  29248      0  2:22:28  0:00:30  2:21:58     0  0  238M    0  870k    0     0  28317      0  2:27:09  0:00:31  2:26:38     0  0  238M    0  875k    0     0  27949      0  2:29:05  0:00:32  2:28:33  1185  0  238M    0  877k    0     0  27145      0  2:33:30  0:00:33  2:32:57  1481  0  238M    0  877k    0     0  26347      0  2:38:09  0:00:34  2:37:35  1481  0  238M    0  877k    0     0  25596      0  2:42:47  0:00:35  2:42:12  1481  0  238M    0  877k    0     0  24886      0  2:47:26  0:00:36  2:46:50  1481  0  238M    0  877k    0     0  24214      0  2:52:05  0:00:37  2:51:28   273  0  238M    0  877k    0     0  23578      0  2:56:43  0:00:38  2:56:05     0  0  238M    0  877k    0     0  22974      0  3:01:22  0:00:39  3:00:43     0  0  238M    0  877k    0     0  22400      0  3:06:01  0:00:40  3:05:21     0  0  238M    0  877k    0     0  21854      0  3:10:40  0:00:41  3:09:59     0  0  238M    0  877k    0     0  21335      0  3:15:18  0:00:42  3:14:36     0  0  238M    0  877k    0     0  20839      0  3:19:57  0:00:43  3:19:14     0  0  238M    0  877k    0     0  20366      0  3:24:36  0:00:44  3:23:52     0  0  238M    0  877k    0     0  19914      0  3:29:14  0:00:45  3:28:29     0  0  238M    0  877k    0     0  19482      0  3:33:53  0:00:46  3:33:07     0  0  238M    0  877k    0     0  19067      0  3:38:32  0:00:47  3:37:45     0  0  238M    0  877k    0     0  18671      0  3:43:10  0:00:48  3:42:22     0  0  238M    0  877k    0     0  18290      0  3:47:49  0:00:49  3:47:00     0  0  238M    0  877k    0     0  17925      0  3:52:27  0:00:50  3:51:37     0  0  238M    0  877k    0     0  17573      0  3:57:07  0:00:51  3:56:16     0  0  238M    0  877k    0     0  17236      0  4:01:45  0:00:52  4:00:53     0  0  238M    0  877k    0     0  16911      0  4:06:24  0:00:53  4:05:31     0  0  238M    0  877k    0     0  16598      0  4:11:03  0:00:54  4:10:09     0  0  238M    0  877k    0     0  16296      0  4:15:42  0:00:55  4:14:47     0  0  238M    0  877k    0     0  16006      0  4:20:20  0:00:56  4:19:24     0  0  238M    0  877k    0     0  15725      0  4:24:59  0:00:57  4:24:02     0  0  238M    0  877k    0     0  15454      0  4:29:38  0:00:58  4:28:40     0  0  238M    0  877k    0     0  15193      0  4:34:16  0:00:59  4:33:17     0  0  238M    0  882k    0     0  14835      0  4:40:53  0:01:00  4:39:53   943  0  238M    0  882k    0     0  14595      0  4:45:30  0:01:01  4:44:29   943  0  238M    0  882k    0     0  14362      0  4:50:08  0:01:02  4:49:06   943  0  238M    0  882k    0     0  14137      0  4:54:45  0:01:03  4:53:42   943  0  238M    0  882k    0     0  13919      0  4:59:22  0:01:04  4:58:18   943  0  238M    0  882k    0     0  13708      0  5:03:58  0:01:05  5:02:53     0  0  238M    0  882k    0     0  13503      0  5:08:35  0:01:06  5:07:29     0  0  238M    0  882k    0     0  13304      0  5:13:12  0:01:07  5:12:05     0  0  238M    0  882k    0     0  13111      0  5:17:49  0:01:08  5:16:41     0  0  238M    0  882k    0     0  12923      0  5:22:26  0:01:09  5:21:17     0  0  238M    0  882k    0     0  12741      0  5:27:02  0:01:10  5:25:52     0  0  238M    0  882k    0     0  12563      0  5:31:41  0:01:11  5:30:30     0  0  238M    0  882k    0     0  12391      0  5:36:17  0:01:12  5:35:05     0  0  238M    0  882k    0     0  12223      0  5:40:54  0:01:13  5:39:41     0  0  238M    0  882k    0     0  12060      0  5:45:31  0:01:14  5:44:17     0  0  238M    0  882k    0     0  11901      0  5:50:08  0:01:15  5:48:53     0  0  238M    0  882k    0     0  11746      0  5:54:45  0:01:16  5:53:29     0  0  238M    0  882k    0     0  11595      0  5:59:22  0:01:17  5:58:05     0  0  238M    0  882k    0     0  11448      0  6:03:59  0:01:18  6:02:41     0  0  238M    0  882k    0     0  11304      0  6:08:37  0:01:19  6:07:18     0  0  238M    0  882k    0     0  11164      0  6:13:14  0:01:20  6:11:54     0  0  238M    0  882k    0     0  11028      0  6:17:51  0:01:21  6:16:30     0  0  238M    0  882k    0     0  10895      0  6:22:27  0:01:22  6:21:05     0  0  238M    0  882k    0     0  10765      0  6:27:04  0:01:23  6:25:41     0  0  238M    0  882k    0     0  10638      0  6:31:42  0:01:24  6:30:18     0  0  238M    0  882k    0     0  10514      0  6:36:19  0:01:25  6:34:54     0  0  238M    0  882k    0     0  10393      0  6:40:56  0:01:26  6:39:30     0  0  238M    0  882k    0     0  10275      0  6:45:32  0:01:27  6:44:05     0  0  238M    0  882k    0     0  10159      0  6:50:10  0:01:28  6:48:42     0  0  238M    0  882k    0     0  10046      0  6:54:47  0:01:29  6:53:18     0  0  238M    0  882k    0     0   9935      0  6:59:25  0:01:30  6:57:55     0  0  238M    0  882k    0     0   9827      0  7:04:01  0:01:31  7:02:30     0  0  238M    0  882k    0     0   9721      0  7:08:39  0:01:32  7:07:07     0  0  238M    0  882k    0     0   9618      0  7:13:14  0:01:33  7:11:41     0  0  238M    0  882k    0     0   9516      0  7:17:53  0:01:34  7:16:19     0  0  238M    0  882k    0     0   9417      0  7:22:29  0:01:35  7:20:54     0  0  238M    0  882k    0     0   9320      0  7:27:05  0:01:36  7:25:29     0  0  238M    0  882k    0     0   9225      0  7:31:42  0:01:37  7:30:05     0  0  238M    0  882k    0     0   9131      0  7:36:21  0:01:38  7:34:43     0  0  238M    0  882k    0     0   9040      0  7:40:56  0:01:39  7:39:17     0  0  238M    0  882k    0     0   8950      0  7:45:34  0:01:40  7:43:54     0  0  238M    0  882k    0     0   8862      0  7:50:12  0:01:41  7:48:31     0  0  238M    0  882k    0     0   8776      0  7:54:48  0:01:42  7:53:06     0  0  238M    0  882k    0     0   8692      0  7:59:23  0:01:43  7:57:40     0  0  238M    0  882k    0     0   8609      0  8:04:01  0:01:44  8:02:17     0  0  238M    0  891k    0     0   8605      0  8:04:14  0:01:46  8:02:28  1854  0  238M    0  912k    0     0   8716      0  7:58:04  0:01:47  7:56:17  5832  0  238M    0  938k    0     0   8868      0  7:49:53  0:01:48  7:48:05 10605  0  238M    0  966k    0     0   9068      0  7:39:31  0:01:49  7:37:42 16575  0  238M    0 1002k    0     0   9332      0  7:26:31  0:01:50  7:24:41 24332  0  238M    0 1044k    0     0   9621      0  7:13:06  0:01:51  7:11:15 31147  0  238M    0 1082k    0     0   9905      0  7:00:41  0:01:51  6:58:50 36417* transfer closed with 248898968 bytes remaining to read
  0  238M    0 1091k    0     0   9981      0  6:57:29  0:01:51  6:55:38 44061
* Closing connection 0
curl: (18) transfer closed with 248898968 bytes remaining to read
+ rcode=200
+ RV=18
+ set -e
+ '[' 18 == 44 ']'
+ '[' 18 '!=' 0 ']'
+ exit 1
+ trap_cleanup
+ exitval=1
+ cleanup
+ unmount_image
+ sync
+ unmount_dir /tmp/image.j0k1q4y3/mnt
+ local pattern=/tmp/image.j0k1q4y3/mnt mnts=
+ '[' -n /tmp/image.j0k1q4y3/mnt ']'
++ awk '{print $2}'
++ grep '^/tmp/image.j0k1q4y3/mnt'
++ sort -r
+ mnts=/tmp/image.j0k1q4y3/mnt/tmp/ccache
+ '[' -n /tmp/image.j0k1q4y3/mnt/tmp/ccache ']'
+ sudo umount -fl /tmp/image.j0k1q4y3/mnt/tmp/ccache
+ '[' -n '' ']'
+ cleanup_build_dir
+ sudo rm -rf /tmp/image.j0k1q4y3/built
+ sudo rm -rf /tmp/image.j0k1q4y3/mnt
+ tmpfs_check 0
+ local echo_message=0
+ '[' 0 == 0 ']'
+ '[' -r /proc/meminfo ']'
++ awk '/^MemTotal/ { print $2 }' /proc/meminfo
+ total_kB=8011304
+ RAM_NEEDED=4
+ '[' 8011304 -lt 4194304 ']'
+ return 0
+ sudo umount -f /tmp/image.j0k1q4y3
+ rm -rf --one-file-system /tmp/image.j0k1q4y3
+ cleanup_image_dir
+ tmpfs_check 0
+ local echo_message=0
+ '[' 0 == 0 ']'
+ '[' -r /proc/meminfo ']'
++ awk '/^MemTotal/ { print $2 }' /proc/meminfo
+ total_kB=8011304
+ RAM_NEEDED=4
+ '[' 8011304 -lt 4194304 ']'
+ return 0
+ sudo umount -f /tmp/image.Sh3HzKKq
+ rm -rf --one-file-system /tmp/image.Sh3HzKKq
+ exit 1
